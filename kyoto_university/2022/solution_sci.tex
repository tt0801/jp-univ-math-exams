\documentclass[dvipdfmx,a4paper]{jsarticle}
    \input{../../settings.tex}
    
    % maketitle
    \title{２０２２年度京大数学（理系）の解答}
    \author{tt0801}
    \date{\today}
    
    \begin{document}
    \maketitle
    \section{大問１}
    \subsection{問題}
    $5.4 < \log_4 2022 < 5.5$であることを示せ. ただし, $0.301 < \log_{10} 2 < 0.3011$であることは用いてよい. 


    \subsection{解答}
    \begin{align*}
        \log_4 2022 &= \dfrac{\log_{10} 2022}{\log_{10} 4} \\
            &= \dfrac{\log_{10} 2 + \log_{10} 1011}{2\log_{10} 2} \\
            &= \dfrac{1}{2} + \dfrac{\log_{10} 1011}{2\log_{10} 2} \ (=A \mathrm{とおく})
    \end{align*}
    である. ここで, $\log_{10} 1011 > \log_{10} 1000 = 3$より, 
    \begin{align*}
        A & > \dfrac{1}{2} + \dfrac{3}{2\log_{10} 2} \\
        & > \dfrac{1}{2} + \dfrac{3}{2\cdot 0.3011} \ (\because \log_{10} 2 < 0.3011)\\
        &= \dfrac{33011}{6022} \\
        &> 5.4
    \end{align*}
    なので, $\log_4 2022 > 5.4$である. 
    
    また, $\log_{10} 1011 < \log_{10} 1024 = 10 \log_{10} 2$なので, 
    \begin{align*}
        A & < \dfrac{1}{2} + \dfrac{10 \log_{10} 2}{2\log_{10} 2} \\
        &= \dfrac{1}{2} + 5\\
        &= 5.5
    \end{align*}
    である. よって, $\log_4 2022 < 5.5$となる. 

    以上より, $5.4 < \log_4 2022 < 5.5$が示された. 


    \subsection{解説}
    $\log_{10} 2$の評価式が与えられているので, $\log_{10} 2$を作ることを意識して式変形をする. 

    \section{大問２}
    \subsection{問題}
    箱の中に1から$n$までの番号がついた$n$枚の札がある. ただし, $n\geq 5$とし, 同じ番号の札はないとする. 
    この箱から3枚の札を同時に取り出し, 札の番号を小さい順に$X, Y, Z$とする. このとき, 
    $Y-X \geq 2$かつ$Z-Y \geq 2$となる確率を求めよ. 

    \subsection{解答}
    $(X,Y,Z)$の組は, 全部で$\comb{n}{3}$通りであり, どの場合が出る確率も等しい. 

    $Y-X=1$となる$(X,Y,Z)$の組の場合の数は, $2\leq Y <Z\leq n$であり, $Y$が定まれば, 
    $X=Y-1$と定まるので, $\comb{n-1}{2}$通りである. 

    同様に, $Z-Y=1$となる$(X,Y,Z)$の組の場合の数は, $1\leq X< Y \leq n-1$であり, $Y$が定まれば, 
    $Z=Y+1$と定まるので, $\comb{n-1}{2}$通りである. 

    また, $Y-X=1$かつ$Z-Y=1$となる$(X,Y,Z)$の組の場合の数は, 
    $1 \leq X \leq n-2$であり, $X$が定まれば, $Y=X+1$, $Z=X+2$と定まるので, 
    $\comb{n-2}{1}$通りである. 

    以上より, $Y-X=1$または$Z-Y=1$となる$(X,Y,Z)$の組の場合の数は, 
    \begin{align*}
        \comb{n-1}{2} + \comb{n-1}{2} - \comb{n-2}{1} &=
        2 \cdot \dfrac{(n-1)(n-2)}{2} - (n-2) \\
        &= (n-2)^2
    \end{align*}
    である. 

    これは, $Y-X \geq 2$かつ$Z-Y \geq 2$となる事象の余事象なので, 
    求める確率$P$は, 

    \begin{align*}
        P &= 1 - \dfrac{(n-2)^2}{\comb{n}{3}} \\
        &= 1 - \dfrac{(n-2)^2}{\dfrac{n(n-1)(n-2)}{6}} \\
        &= 1 - \dfrac{6(n-2)}{n(n-1)} \\
        &= \dfrac{n(n-1) - 6(n-2)}{n(n-1)} \\
        &= \dfrac{n^2 -7n + 12}{n(n-1)} \\
        &= \dfrac{(n-3)(n-4)}{n(n-1)}
    \end{align*}
    である. 

    \subsection{解説}
    $n=3,4$を代入して, 求める確率が0であることから検算できる. 
    また, $n=5$の時も$Y-X \geq 2$かつ$Z-Y \geq 2$となるのは, $(X,Y,Z)=(1,3,5)$
    の組だけなので, 求める確率が$\dfrac{1}{\comb{5}{3}}=\dfrac{1}{10}$になっているか
    でも検算可能. 


    \section{大問３}
    \subsection{問題}
    $n$を自然数とする. ３つの整数$n^2+2$, $n^4+2$, $n^6+2$の最大公約数$A_n$を求めよ. 

    \subsection{解答}
    $(n^4+2) - (n^2+2) = n^2(n^2-1)$なので, $n^4+2$と$n^2+2$の最大公約数は, 
    $n^2+2$と$n^2(n^2-1)$の最大公約数に一致する. 

    $n^2+2$と$n^2$の最大公約数について考える. 
    $n^2+2$と$n^2$の公約数は, $(n^2+2)-n^2=2$を割り切る. 
    ゆえに, $n$が偶数の時は, $n^2+2$, $n^2$はともに偶数なので, 最大公約数は2である. 
    $n$が奇数の時は, $n^2+2$, $n^2$はともに奇数なので, 最大公約数は1である. 

    $n^2+2$と$n^2-1$の最大公約数について考える. 
    $n^2+2$と$n^2-1$の公約数は, $(n^2+2)-(n^2-1)=3$を割り切る. 
    ゆえに, $n$が3の倍数の時は, $n^2+2$, $n^2-1$はともに3の倍数ではないので, 最大公約数は1である. 
    $n$が3の倍数でない時は, $n^2+2$, $n^2-1$はともに3の倍数なので, 最大公約数は3である. 

    $n^2$と$n^2-1$は互いに素なので, $n^2+2$と$n^2(n^2-1)$の最大公約数は, 
    $n^2+2$と$n^2$の最大公約数と$n^2+2$と$n^2-1$の最大公約数の積である. 

    以上より, $n^2+2$と$n^2(n^2-1)$の最大公約数$B_n$は, 
    \begin{eqnarray*}
        B_n = \left\{
            \begin{array}{lll}
                2 & (n\mathrm{は偶数かつ3の倍数, すなわち6の倍数}), \\
                6 & (n\mathrm{は偶数だが3の倍数ではない, すなわち6で割って2または4余る}), \\
                1 & (n\mathrm{は奇数かつ3の倍数, すなわち6で割って3余る}), \\
                3 & (n\mathrm{は奇数だが3の倍数ではない, すなわち6で割って1または5余る})
            \end{array}
        \right.
    \end{eqnarray*}
    で与えられる. これが$n^4+2$と$n^2+2$の最大公約数に一致するので, 
    $A_n$は, $B_n$と$n^6+2$の最大公約数である. 
    
    一方で, $n^6+2 = n^2+2 + (n^2+1) \cdot n^2(n^2-1)$と表せるので, 
    $n^6+2$は, $n^2+2$と$n^2(n^2-1)$の最大公約数$B_n$で割り切れる. 

    以上より, $A_n = B_n$であるので, 
    \begin{eqnarray*}
        A_n = \left\{
            \begin{array}{lll}
                2 & (n\mathrm{は6の倍数}), \\
                6 & (n\mathrm{は6で割って2または4余る}), \\
                1 & (n\mathrm{は6で割って3余る}), \\
                3 & (n\mathrm{は6で割って1または5余る})
            \end{array}
        \right.
    \end{eqnarray*}
    である. 


    \subsection{解説}
    ユークリッドの互除法が背景にある問題である. 整数$x,y,q,r$について, $x = qy +r$
    と表せる時, $x,y$の最大公約数は$y,r$の最大公約数と一致する. 


    \section{大問４}
    \subsection{問題}
    四面体OABCが
    \begin{equation*}
        \mathrm{
            OA = 4,\ OB=AB=BC=3,\ OC=AC=2\sqrt{3}
        }
    \end{equation*}
    を満たしているとする. 点Pを辺BC上の点とし, $\triangle \mathrm{OAP}$の
    重心をGとする. このとき, 次の各問に答えよ. 
    \begin{itemize}
        \item [(1)] $\oraw{\mathrm{PG}} \perp \oraw{\mathrm{OA}}$を示せ. 
        \item [(2)] Pが辺BC上を動くとき, PGの最小値を求めよ. 
    \end{itemize}

    \subsection{解答}
    \begin{itemize}
        \item [(1)] 一次独立なベクトル$\oraw{\mathrm{OA}}$, $\oraw{\mathrm{OB}}$, $\oraw{\mathrm{OC}}$
        に着目する. 
        \begin{align*}
            \oraw{\mathrm{OA}} \cdot \oraw{\mathrm{OB}}
            &= \dfrac{|\oraw{\mathrm{OA}}|^2 + |\oraw{\mathrm{OB}}|^2 - |\oraw{\mathrm{AB}}|^2}{2} \\
            &= \dfrac{16 + 9 - 9}{2} \\
            &= 8, \\
            \oraw{\mathrm{OB}} \cdot \oraw{\mathrm{OC}}
            &= \dfrac{|\oraw{\mathrm{OB}}|^2 + |\oraw{\mathrm{OC}}|^2 - |\oraw{\mathrm{BC}}|^2}{2} \\
            &= \dfrac{9 + 12 - 9}{2} \\
            &= 6, \\
            \oraw{\mathrm{OA}} \cdot \oraw{\mathrm{OC}}
            &= \dfrac{|\oraw{\mathrm{OA}}|^2 + |\oraw{\mathrm{OC}}|^2 - |\oraw{\mathrm{AC}}|^2}{2} \\
            &= \dfrac{16 + 12 - 12}{2} \\
            &= 8.
        \end{align*}
        点Pは辺BC上にあるので, 0以上1以下の実数$t$を用いて
        \begin{equation*}
            \oraw{\mathrm{OP}} = t\oraw{\mathrm{OB}} + (1-t)\oraw{\mathrm{OC}}
        \end{equation*}
        と表せる. 点Gは$\triangle \mathrm{OAP}$の重心なので, 
        \begin{align*}
            \oraw{\mathrm{OG}} &= \dfrac{1}{3}\oraw{\mathrm{OA}} + \dfrac{1}{3}\oraw{\mathrm{OP}}
        \end{align*}
        だから, 
        \begin{align*}
            \oraw{\mathrm{PG}} &= \oraw{\mathrm{OG}} - \oraw{\mathrm{OP}} \\
            &= \dfrac{1}{3}\oraw{\mathrm{OA}} - \dfrac{2}{3}\oraw{\mathrm{OP}} \\
            &= \dfrac{1}{3}\oraw{\mathrm{OA}} - \dfrac{2}{3}t\oraw{\mathrm{OB}} - \dfrac{2}{3} (1-t)\oraw{\mathrm{OC}}
        \end{align*}
        である. 特に, $\oraw{\mathrm{OA}}$, $\oraw{\mathrm{OB}}$, $\oraw{\mathrm{OC}}$の係数が全て
        0になることはないので, 2点P, Gは一致しない. 
        \begin{align*}
            \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OA}} &=
            \dfrac{1}{3}|\oraw{\mathrm{OA}}|^2 
            - \dfrac{2}{3}t\oraw{\mathrm{OB}} \cdot \oraw{\mathrm{OA}} 
            - \dfrac{2}{3} (1-t)\oraw{\mathrm{OC}} \cdot \oraw{\mathrm{OA}} \\
            &= \dfrac{1}{3} \cdot 16 - \dfrac{2}{3}t \cdot 8 - \dfrac{2}{3} (1-t) \cdot 8 \\
            &= 0
        \end{align*}
        で, $\mathrm{PG} >0$, $\mathrm{OA}=4>0$なので, 
        $\oraw{\mathrm{PG}} \perp \oraw{\mathrm{OA}}$が導けた. 

        \item [(2)] $|\oraw{\mathrm{PG}}|^2$の最小値について考える. 
        \begin{align*}
            |\oraw{\mathrm{PG}}|^2 &= \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{PG}} \\
            &= \oraw{\mathrm{PG}} \cdot \left(\dfrac{1}{3}\oraw{\mathrm{OA}} - \dfrac{2}{3}t\oraw{\mathrm{OB}} - \dfrac{2}{3} (1-t)\oraw{\mathrm{OC}} \right) \\
            &= - \dfrac{2}{3}t \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OB}} - \dfrac{2}{3} (1-t) \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OC}}
        \end{align*}
        である. 
        \begin{align*}
            \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OB}} &=
            \dfrac{1}{3}\oraw{\mathrm{OA}} \cdot \oraw{\mathrm{OB}} 
            - \dfrac{2}{3}t |\oraw{\mathrm{OB}}|^2
            - \dfrac{2}{3} (1-t)\oraw{\mathrm{OC}} \cdot \oraw{\mathrm{OB}} \\
            &= \dfrac{1}{3} \cdot 8 - \dfrac{2}{3}t \cdot 9 - \dfrac{2}{3} (1-t) \cdot 6 \\
            &= -2t - \dfrac{4}{3}, \\
            \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OC}} &=
            \dfrac{1}{3}\oraw{\mathrm{OA}} \cdot \oraw{\mathrm{OC}} 
            - \dfrac{2}{3}t \oraw{\mathrm{OB}} \cdot \oraw{\mathrm{OC}} 
            - \dfrac{2}{3} (1-t) |\oraw{\mathrm{OC}}|^2 \\
            &= \dfrac{1}{3} \cdot 8 - \dfrac{2}{3}t \cdot 6 - \dfrac{2}{3} (1-t) \cdot 12 \\
            &= 4t - \dfrac{16}{3} \\
        \end{align*}
        なので, 
        \begin{align*}
            |\oraw{\mathrm{PG}}|^2 
            &= - \dfrac{2}{3}t \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OB}} - \dfrac{2}{3} (1-t) \oraw{\mathrm{PG}} \cdot \oraw{\mathrm{OC}} \\
            &= - \dfrac{2}{3}t \left(-2t - \dfrac{4}{3}\right) - \dfrac{2}{3} (1-t) \left(4t - \dfrac{16}{3}\right) \\
            &= 4t^2 - \dfrac{16}{3}t + \dfrac{32}{9} \\
            &= 4 \left(t- \dfrac{2}{3}\right)^2 + \dfrac{16}{9} \\
            &\geq \dfrac{16}{9}. 
        \end{align*}
        等号成立条件は, $t=\dfrac{2}{3}$であり, これは$0\leq t\leq 1$を満たす. 
        このとき, 点Pは辺BCを1:2に内分する点である. また, $\mathrm{PG} = \sqrt{|\oraw{\mathrm{PG}}|^2 } = \dfrac{4}{3}$. 

        以上より, 点Pは辺BCを1:2に内分する点である時, PGは最小値$\dfrac{4}{3}$をとる. 

    \end{itemize}
    
    \subsection{解説}
    ベクトルの問題では, 基底(一次独立かつ, 空間の任意のベクトルが基底のベクトルの一次結合で表せる)
    に着目して式変形しよう. 本問では例えば, $\left\{\oraw{\mathrm{OA}}, \oraw{\mathrm{OB}}, \oraw{\mathrm{OC}}\right\}$
    が基底である. 
    
    \section{大問５}
    \subsection{問題}
    曲線$C: y=\cos ^3 x \ \left(0 \leq x \leq \dfrac{\pi}{2}\right)$, $x$軸および
    $y$軸で囲まれる図形の面積を$S$とする. $0<t<\dfrac{\pi}{2}$とし, $C$上の点Q$(t, \cos ^3 t)$
    と原点$O$およびP$(t,0)$, R$(0, \cos ^3 t)$を頂点に持つ長方形OPQRの面積を$f(t)$とする. 
    このとき, 次の各問に答えよ. 
    \begin{itemize}
        \item [(1)] $S$を求めよ. 
        \item [(2)] $f(t)$は最大値をただ１つの$t$でとることを示せ. そのときの$t$を$\al$
        とすると, $f(\al) = \dfrac{\cos ^4 \al}{3 \sin \al}$であることを示せ. 
        \item [(3)] $\dfrac{f(\al)}{S} < \dfrac{9}{16}$を示せ. 
    \end{itemize}

    \subsection{解答}
    \begin{itemize}
        \item [(1)] 求める面積$S$は, 
        \begin{align*}
            S &= \int_0^{\dfrac{\pi}{2}} \cos ^3 x \ dx \\
            &= \int_0^{\dfrac{\pi}{2}} (1- \sin^2 x) \cos x \ dx \\
            &= \left[ \sin x - \dfrac{1}{3} \sin^3 x\right]_0^{\dfrac{\pi}{2}} \\
            &= \dfrac{2}{3}
        \end{align*}
        である. 
        \item [(2)] $f(t) = t \cos ^3 t$である. 
        \begin{align*}
            f'(t) &= \cos ^3 t - 3t\cos ^2 t\sin t \\
            &=  \cos ^2 t(\cos t - 3t\sin t) \\
        \end{align*}
        $0 < t < \dfrac{\pi}{2}$において, $\cos ^2 t >0$なので, 
        $f'(t)$の0との大小関係は$g(t):=\cos t - 3t\sin t$の0との大小関係と一致する. 
        \begin{align*}
            g'(t) &= - \sin t- 3\sin ^2 t -3t \cos t \\
            & < 0
        \end{align*}
        であるので, $g(t)$は$0 < t < \dfrac{\pi}{2}$において単調減少である. 
        \begin{align*}
            \lim_{t \to +0} g(t) = 1>0,  \quad 
            \lim_{t \to \dfrac{\pi}{2}-0} g(t) &= -\dfrac{3}{2}\pi <0
        \end{align*}
        であるから中間値の定理より$g(\al) = 0$となる$0<\al< \dfrac{\pi}{2}$となる
        $\al$が存在する. $f(t)$の増減表をかくと, 

        \[
            \begin{array}{|c|c|c|c|c|c|}
            \hline
            x     & 0 &   & \al &   & \dfrac{\pi}{2} \\ \hline
            g(x)  &   & + & 0      & - & \\ \hline
            f'(x) &   & + & 0      & - &  \\ \hline
            f(x)  &   & \nearrow & \mathrm{最大} & \searrow & \\ \hline
            \end{array}
        \]
        だから, $f(t)$は最大値を$t=\al$でのみ取る. $g(\al) =0$すなわち, 
        \begin{equation*}
            \cos \al - 3\al \sin \al =0
        \end{equation*}
        に注意すると, $\al = \dfrac{\cos \al}{3\sin \al}$であるから, 
        \begin{align*}
            f(\al) &= \al \cos ^3 \al \\
            &= \al \cos ^3 \al \\
            &= \dfrac{\cos ^4 \al}{3\sin \al}
        \end{align*}
        となる. 

        \item [(3)] 
        \begin{align*}
            g\left(\dfrac{\pi}{6}\right) 
            &= \dfrac{\sqrt{3}}{2} -3 \cdot \dfrac{\pi}{6} \cdot \dfrac{1}{2} \\
            &= \dfrac{2\sqrt{3} - \pi }{4} \\
            & >0
        \end{align*}
        であるから, $\dfrac{\pi}{6} < \al   \ \left(< \dfrac{\pi}{2}\right)$である. ゆえに, 
        \begin{align*}
            f(\al) 
            &= \dfrac{\cos ^4 \al}{3\sin \al} \\
            &< \dfrac{\cos ^4 \dfrac{\pi}{6}}{3\sin \dfrac{\pi}{6}} \\
            &< \dfrac{\left(\dfrac{\sqrt{3}}{2}\right)^4}{3\cdot \dfrac{1}{2}} \\
            & = \dfrac{3}{8}
        \end{align*}
        である. 両辺$S=\dfrac{2}{3}$で割って, 
        \begin{align*}
            \dfrac{f(\al)}{S} < \dfrac{9}{16}
        \end{align*}
        を得る. 
    \end{itemize}

    \subsection{解説}
    $x,y$についての有理関数$Q(x,y)$について, $Q(\cos x, \sin x)$は原理的に
    高校数学の範囲で積分を計算できる. $Q(x,y)$の形に応じて様々なテクニックが
    あるので, 復習しよう. 



    \section{大問６}
    \subsection{問題}
    数列 $\{x_n\}, \{y_n\}$ を次の式
    \[
        x_1 = 0, \quad x_{n+1} = x_n + n + 2\cos\left( \frac{2\pi x_n}{3} \right) \quad (n=1, 2, 3, \ldots)
    \]
    \[
        y_{3m+1} = 3m, \quad y_{3m+2} = 3m+2, \quad y_{3m+3} = 3m+4 \quad (m=0, 1, 2, \ldots)
    \]
    により定める. このとき, 数列 $\{x_n - y_n\}$ の一般項を求めよ. 

    \subsection{解答}
    任意の0以上の整数$m$に対して, 次の命題$P(m)$が成立することを, 数学的帰納法で証明する. 
    
    \begin{equation*}
        P(m): \quad x_{3m+1}, x_{3m+2}, x_{3m+3}
        \mathrm{はいずれも整数で, 3で割った余りはそれぞれ0, 0, 1である. }
    \end{equation*}
    
    
    \begin{itemize}
        \item [(i)] $m=0$の時, $x_{3\cdot 0 + 1} = x_1 = 0$は整数. 3で割った余りは0. 
        \begin{align*}
            x_{3\cdot 0 + 2} &= x_2 \\
            &= x_1 + 1 + 2\cos\left( \dfrac{2\pi x_1}{3} \right)\\
            &= 0 + 1 + 2 \cos 0\\
            &=3. 
        \end{align*}
        これは整数であり, 3で割った余りは0. 
        \begin{align*}
            x_{3\cdot 0 + 3} &= x_3 \\
            &= x_2 + 2  + 2\cos\left( \dfrac{2\pi x_2}{3} \right)\\
            &= 3 + 2 + 2 \cos \left(2\pi \right) \\
            &=7. 
        \end{align*}
        これは整数であり, 3で割った余りは1. 

        よって, $m=0$では命題$P(m)$が成立. 

        \item [(ii)] ある0以上の整数$m$に対して, $P(m)$が真であると仮定する. 
        この時, 
        \begin{align*}
            x_{3 (m+1) + 1} &= x_{3m + 4} \\
            &= x_{3m+3} + (3m+3) + 2\cos\left( \dfrac{2\pi x_{3m+3}}{3} \right)\\
            &= x_{3m+3} + (3m+3) + 2\cos\left( \dfrac{2\pi}{3} \right) \\
            &= x_{3m+3} + 3m -1.
        \end{align*}
        $x_{3m+3}$は3で割って1余る整数なので, $x_{3 (m+1) + 1}$は
        整数であり, 3で割った余りは0である. 
        \begin{align*}
            x_{3 (m+1) + 2} &= x_{3m + 5} \\
            &= x_{3m+4} + (3m+4) + 2\cos\left( \dfrac{2\pi x_{3m+4}}{3} \right)\\
            &= x_{3m+4} + (3m+4) + 2\cos 0 \\
            &= x_{3m+4} + 3m + 6.
        \end{align*}
        $x_{3m+4}$は3で割り切れる整数なので, $x_{3 (m+1) + 2}$は
        整数であり, 3で割った余りは0である. 
        \begin{align*}
            x_{3 (m+1) + 3} &= x_{3m + 6} \\
            &= x_{3m+5} + (3m+5) + 2\cos\left( \dfrac{2\pi x_{3m+5}}{3} \right)\\
            &= x_{3m+5} + (3m+5) + 2\cos 0 \\
            &= x_{3m+5} + 3m + 7.
        \end{align*}
        $x_{3m+5}$は3で割り切れる整数なので, $x_{3 (m+1) + 3}$は
        整数であり, 3で割った余りは1である. 
        
    \end{itemize}

    以上より任意の0以上の整数$m$に対して, 命題$P(m)$が成立する. 

    $n$が2以上の整数の時, 
    \begin{align*} \displaystyle
        x_n 
        &= x_1 + \sum_{k=1}^{n-1} \left\{k + 2 \cos \left( \dfrac{2\pi}{3}x_k\right)\right\} \\
        &= \dfrac{n(n-1)}{2} + 2 \sum_{k=1}^{n-1} \cos \left( \dfrac{2\pi}{3}x_k\right)
    \end{align*}
    である. $\displaystyle z_n = 2 \sum_{k=1}^{n-1} \cos \left( \dfrac{2\pi}{3}x_k\right)$とおく. 
    また, $z_1 = 0$とおけば, 全ての自然数$n$について, $x_n = \dfrac{n(n-1)}{2} + z_n$が成立する. 

    $m$が自然数の時, 
    \begin{align*}
        z_{3m+1} &= 2 \sum_{k=1}^{3m} \cos \left( \dfrac{2\pi}{3}x_k\right) \\
        &= 2 \sum_{k=0}^{m-1} \left\{\cos \left( \dfrac{2\pi}{3}x_{3k+1}\right) + \cos \left( \dfrac{2\pi}{3}x_{3k+2}\right) + \cos \left( \dfrac{2\pi}{3}x_{3k+3}\right)\right\} \\
        &= 2 \sum_{k=0}^{m-1} \left(1 + 1 - \dfrac{1}{2}\right) \\
        &= 3m \\
        &= y_{3m+1}, \\
        z_{3m+2} &= z_{3m+1} + 2\cos \left( \dfrac{2\pi}{3}x_{3m+1}\right)\\
        &= 3m + 2\\
        &= y_{3m+2}, \\
        z_{3m+3} &= z_{3m+2} + 2\cos \left( \dfrac{2\pi}{3}x_{3m+2}\right)\\
        &= 3m + 2 + 2\\
        &= 3m + 4\\
        &= y_{3m+3}
    \end{align*}
    である. これは, 
    \begin{align*}
        z_1 &= 1 = y_1, \\
        z_2 &= 2\cos \left( \dfrac{2\pi}{3}x_1\right) = 2 = y_2, \\
        z_3 &= z_2 + 2\cos \left( \dfrac{2\pi}{3}x_2\right) 
        = 2 + 2
        = 4
        = y_3
    \end{align*}
    なので, $m=0$に対しても成立する. 

    以上より, 全ての自然数$n$に対して, $z_n = y_n$なので, 
    \begin{equation*}
        x_n - y_n = \dfrac{n(n-1)}{2}
    \end{equation*}
    が全ての自然数$n$に対して, 成立する. 

    \subsection{解説}
    いくつか$x_n$を具体的に計算すれば, $x_n$は整数であることが期待できる. 
    この時, $2\cos\left( \dfrac{2\pi x_n}{3} \right)$の取りうる値は$x_n$を3で割った余りによって
    2か-1のいずれかなので, $x_n$の3の剰余に着目すれば周期的になっていることが見抜けるだろう. 


\end{document}